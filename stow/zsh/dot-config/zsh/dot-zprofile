# ~/.config/zsh/.zprofile

typeset -gxU path PATH

# XDG fallbacks
: "${XDG_DATA_HOME:=$HOME/.local/share}"
: "${XDG_CACHE_HOME:=$HOME/.cache}"
: "${XDG_CONFIG_HOME:=$HOME/.config}"

export LANG=en_GB.UTF-8
export LC_CTYPE=en_GB.UTF-8

# Homebrew (portable)
if [[ -x /opt/homebrew/bin/brew ]]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
elif [[ -x /usr/local/bin/brew ]]; then
  eval "$(/usr/local/bin/brew shellenv)"
fi

# Coursier: add its bin dir (macOS default lives under ~/Library/... with spaces)
# Use zsh's path array; quoting handles spaces.
if [[ -d "$HOME/Library/Application Support/Coursier/bin" ]]; then
  path+=("$HOME/Library/Application Support/Coursier/bin")
fi

# Histories / state (optional)
export HISTFILE="${XDG_STATE_HOME:-$HOME/.local/state}/zsh/history"
export LESSHISTFILE="${XDG_STATE_HOME:-$HOME/.local/state}/less/history"
export PSQL_HISTORY="${XDG_STATE_HOME:-$HOME/.local/state}/psql/history"

# Ruby
export RBENV_ROOT="$XDG_DATA_HOME/rbenv"
export GEM_HOME="$XDG_DATA_HOME/gem"
export GEM_SPEC_CACHE="$XDG_CACHE_HOME/gem"
export GEMRC="$XDG_CONFIG_HOME/gem/gemrc"
path+=("$GEM_HOME/bin")

# NPM
export NPM_CONFIG_USERCONFIG="${XDG_CONFIG_HOME:-$HOME/.config}/npm/npmrc"
export NPM_CONFIG_CACHE="${XDG_CACHE_HOME:-$HOME/.cache}/npm"
export NPM_CONFIG_PREFIX="${XDG_DATA_HOME:-$HOME/.local/share}/npm"
path+=("$NPM_CONFIG_PREFIX/bin")

# Tool caches & JVM opts
export KONAN_DATA_DIR="$XDG_DATA_HOME/konan"
export GRADLE_USER_HOME="$XDG_DATA_HOME/gradle"
export IVY_HOME="$XDG_CACHE_HOME/ivy2"
export SBT_OPTS="${SBT_OPTS:-} -Dsbt.global.base=$XDG_DATA_HOME/sbt -Dsbt.boot.directory=$XDG_CACHE_HOME/sbt/boot -Dsbt.ivy.home=$IVY_HOME"
export COURSIER_CACHE="$XDG_CACHE_HOME/coursier"
export BLOOP_JAVA_OPTS="-Xms1g -Xmx4g -XX:+UseG1GC -XX:ReservedCodeCacheSize=256m"

export DOCKER_CONFIG="${XDG_CONFIG_HOME:-$HOME/.config}/docker"

# hledger files
# export LEDGER_FILE="$HOME/Documents/10 Finanzen/hledger.journal"

export HOMEBREW_NO_ENV_HINTS=1

